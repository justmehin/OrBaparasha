<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">טוען מאמר...</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700&family=Noto+Serif+Hebrew:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { beigeTheme: '#f8f1e7' },
                    fontFamily: {
                        sans: ['Heebo', 'sans-serif'],
                        serif: ['Noto Serif Hebrew', 'serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #f8f1e7; }
        .article-content { line-height: 1.8; font-size: 1.15rem; }
        .article-content p { margin-bottom: 1.5rem; }
    </style>
</head>
<body class="font-sans antialiased text-slate-800">

    <nav class="fixed top-0 left-0 w-full z-50 bg-white/80 backdrop-blur-md border-b border-black/5 px-6 py-4">
        <div class="max-w-4xl mx-auto flex justify-between items-center">
            <a href="#" id="back-to-book" class="inline-flex items-center gap-2 font-bold text-sm transition-all no-underline">
                <span class="material-symbols-outlined text-lg">arrow_forward</span>
                חזרה לפרשות
            </a>
            <span id="nav-book-name" class="font-serif font-bold text-lg opacity-50"></span>
        </div>
    </nav>

    <header class="pt-32 pb-16 px-6 bg-white border-b border-black/5">
        <div class="max-w-3xl mx-auto text-center">
            <h1 id="article-title" class="text-4xl md:text-6xl font-serif font-bold mb-4 leading-tight"></h1>
            <p id="article-subtitle" class="text-xl text-slate-500 font-light max-w-2xl mx-auto"></p>
        </div>
    </header>

    <main class="max-w-3xl mx-auto px-6 py-16">
        <div id="article-body" class="article-content text-slate-700 font-normal">
            <div class="flex flex-col gap-4 animate-pulse">
                <div class="h-4 bg-slate-200 rounded w-3/4"></div>
                <div class="h-4 bg-slate-200 rounded"></div>
                <div class="h-4 bg-slate-200 rounded w-5/6"></div>
            </div>
        </div>
    </main>

    <footer class="py-20 text-center text-slate-400 text-xs tracking-widest">
        &copy; 2026 • אור בפרשה
    </footer>

    <script>
        const booksData = {
            'bereshit': { name: 'ספר בראשית', color: '#10b981' },
            'shmot': { name: 'ספר שמות', color: '#f97316' },
            'vaikra': { name: 'ספר ויקרא', color: '#a855f7' },
            'bamidbar': { name: 'ספר במדבר', color: '#d97706' },
            'devarim': { name: 'ספר דברים', color: '#0284c7' }
        };

        async function loadArticle() {
            const params = new URLSearchParams(window.location.search);
            const parashaId = params.get('parasha');
            const bookId = params.get('book') || 'bereshit';
            const bookInfo = booksData[bookId];

            if (!parashaId) {
                window.location.href = 'index.html';
                return;
            }

            // 1. הגדרת עיצוב לפי הספר
            document.getElementById('back-to-book').style.color = bookInfo.color;
            document.getElementById('back-to-book').href = `book.html?book=${bookId}`;
            document.getElementById('nav-book-name').textContent = bookInfo.name;
            document.getElementById('article-title').style.color = bookInfo.color;

            // 2. טעינת תוכן הקובץ
            try {
                const response = await fetch(`parashot/${parashaId}.txt`);
                if (!response.ok) throw new Error('File not found');
                
                const fullText = await response.text();
                const lines = fullText.split('\n');
                
                let cleanContent = "";
                let title = parashaId;
                let subtitle = "";

                // פירוק הקובץ לשורות (כותרת, תת כותרת ותוכן)
                lines.forEach(line => {
                    if (line.startsWith('title:')) {
                        title = line.replace('title:', '').trim();
                    } else if (line.startsWith('subtitle:')) {
                        subtitle = line.replace('subtitle:', '').trim();
                    } else if (line.startsWith('image:')) {
                        // מתעלמים מהתמונה כאן אם רוצים
                    } else if (line.trim() !== "") {
                        cleanContent += `<p>${line.trim()}</p>`;
                    }
                });

                // 3. הזרקה לדף
                document.title = `${title} | אור בפרשה`;
                document.getElementById('article-title').textContent = title;
                document.getElementById('article-subtitle').textContent = subtitle;
                document.getElementById('article-body').innerHTML = cleanContent;

            } catch (error) {
                document.getElementById('article-body').innerHTML = `
                    <div class="text-center py-20">
                        <span class="material-symbols-outlined text-6xl text-slate-300 mb-4">description</span>
                        <p class="text-slate-500">מצטערים, לא נמצא תוכן עבור פרשה זו.</p>
                        <a href="book.html?book=${bookId}" class="text-blue-500 underline mt-4 block">חזרה לרשימה</a>
                    </div>
                `;
            }
        }

        loadArticle();
    </script>
</body>
</html>
