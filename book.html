<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">אור בפרשה</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;700&family=Noto+Serif+Hebrew:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        beigeTheme: '#f1dcc1',
                    },
                    fontFamily: {
                        sans: ['Heebo', 'sans-serif'],
                        serif: ['Noto Serif Hebrew', 'serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { 
            background: linear-gradient(to bottom, white 0%, white 15%, #f1dcc1 60%, #f1dcc1 100%);
            margin: 0; 
            overflow-x: hidden; 
            min-height: 100vh;
        }

        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        
        .floating-card { 
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            background-color: white; 
        }
        
        .floating-card:hover { 
            box-shadow: 0 25px 45px -10px rgba(0, 0, 0, 0.12), 0 15px 20px -5px rgba(0, 0, 0, 0.05);
            transform: translateY(-8px);
        }

        .image-fallback {
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(0,0,0,0.05));
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hero-mask {
            mask-image: linear-gradient(to bottom, black 75%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, black 75%, transparent 100%);
        }

        .hero-gradient-fallback {
            background: linear-gradient(180deg, var(--book-color-dark) 0%, var(--book-color-light) 100%);
        }
    </style>
</head>
<body class="font-sans antialiased text-slate-800">

    <div id="hero-section" class="fixed top-0 left-0 w-full h-[80vh] z-0 overflow-hidden hero-mask">
        <div id="hero-bg" class="absolute inset-0 bg-cover bg-center transition-opacity duration-700"></div>
        <div id="hero-overlay" class="absolute inset-0 bg-black/25"></div>
        
        <div class="absolute top-8 right-8 z-20">
            <a href="index.html" id="back-link" class="inline-flex items-center gap-2 font-bold text-sm bg-white/20 backdrop-blur-md px-5 py-2.5 rounded-full hover:bg-white/40 transition-all no-underline text-white border border-white/30">
                <span class="material-symbols-outlined text-lg">arrow_forward</span>
                חזרה
            </a>
        </div>

        <div id="hero-content" class="absolute inset-0 flex flex-col items-center justify-center text-white text-center px-6">
            <div id="icon-container" class="w-20 h-20 rounded-full mb-6 shadow-2xl border-4 border-white/80 flex items-center justify-center">
                <span id="book-icon" class="material-symbols-outlined text-4xl"></span>
            </div>
            <h1 id="main-title" class="text-5xl md:text-7xl font-serif font-bold drop-shadow-2xl mb-4"></h1>
            <p id="main-description" class="text-xl md:text-2xl font-light max-w-2xl opacity-95 leading-relaxed drop-shadow-lg"></p>
        </div>
    </div>

    <div class="relative z-10 mt-[85vh]">
        <div class="pb-24 px-6">
            <main class="max-w-4xl mx-auto">
                <div id="parasha-grid" class="flex flex-col gap-8">
                </div>
            </main>
        </div>

        <footer class="py-12 text-center text-slate-500 text-xs tracking-widest border-t border-black/5">
            &copy; 2026 • אור בפרשה
        </footer>
    </div>

    <script>
        const booksData = {
            'bereshit': { name: 'ספר בראשית', desc: 'יסודות האמונה ובניית המשפחה היהודית הראשונה.', color: '#10b981', lightColor: '#065f46', icon: 'public', hero: 'https://images.unsplash.com/photo-1501290830384-93ad47898391?q=80&w=1600', parashot: [
                { id: 'bereshit', name: 'בראשית', desc: 'בריאת העולם, חטא אדם וחוה וסיפור קין והבל.', img: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400' },
                { id: 'noach', name: 'נח', desc: 'תיבת נח, המבול וההבטחה לקיום העולם מחדש.', img: 'https://images.unsplash.com/photo-1533713619779-3c7333550066?w=400' },
                { id: 'lech-lecha', name: 'לך לך', desc: 'מסעו של אברהם אבינו אל הארץ המובטחת.', img: 'https://images.unsplash.com/photo-1445108849235-41a09707b931?w=400' },
                { id: 'vayeira', name: 'וירא', desc: 'ביקור המלאכים, הפיכת סדום ועקדת יצחק.', img: 'https://images.unsplash.com/photo-1472214103451-9374bd1c798e?w=400' },
                { id: 'chayei-sarah', name: 'חיי שרה', desc: 'קניית מערת המכפלה ומציאת רבקה ליצחק.', img: 'https://images.unsplash.com/photo-1505305976870-c0be144022c4?w=400' },
                { id: 'toledot', name: 'תולדות', desc: 'המאבק בין יעקב ועשיו על הבכורה והברכות.', img: 'https://images.unsplash.com/photo-1470770841072-f978cf4d019e?w=400' },
                { id: 'vayetze', name: 'ויצא', desc: 'חלום הסולם, שנות העבודה אצל לבן והקמת השבטים.', img: 'https://images.unsplash.com/photo-1493246507139-91e8bef99c02?w=400' },
                { id: 'vayishlach', name: 'וישלח', desc: 'המפגש עם עשיו והמאבק עם המלאך.', img: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=400' },
                { id: 'vayeishev', name: 'וישב', desc: 'מכירת יוסף, חלומותיו וירידתו למצרים.', img: 'https://images.unsplash.com/photo-1439853949127-fa647821eba0?w=400' },
                { id: 'mikeitz', name: 'מקץ', desc: 'פתרון חלומות פרעה ומינוי יוסף למשנה למלך.', img: 'https://images.unsplash.com/photo-1472396961693-142e6e269027?w=400' },
                { id: 'vayigash', name: 'ויגש', desc: 'חשיפת יוסף בפני אחיו וירידת יעקב למצרים.', img: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=400' },
                { id: 'vayechi', name: 'ויחי', desc: 'ברכות יעקב לבניו לפני מותו בסוף תקופת האבות.', img: 'https://images.unsplash.com/photo-1426604966848-d7adac402bdb?w=400' }
            ]},
            'shmot': { name: 'ספר שמות', desc: 'מיציאה מעבדות לחירות, מעמד הר סיני ובניית המשכן.', color: '#f97316', lightColor: '#9a3412', icon: 'local_fire_department', hero: 'https://images.unsplash.com/photo-1502481851512-e9e2529bbbf9?q=80&w=1600', parashot: [
                { id: 'shmot', name: 'שמות', desc: 'שעבוד מצרים, לידת משה והסנה הבוער.', img: 'https://images.unsplash.com/photo-1543722530-d2c3201371e7?w=400' },
                { id: 'vaera', name: 'וארא', desc: 'שבע המכות הראשונות וחיזוק לב פרעה.', img: 'https://images.unsplash.com/photo-1510002165351-784860178385?w=400' },
                { id: 'bo', name: 'בא', desc: 'שלוש המכות האחרונות ויציאת מצרים.', img: 'https://images.unsplash.com/photo-1502481851512-e9e2529bbbf9?w=400' },
                { id: 'beshalach', name: 'בשלח', desc: 'קריעת ים סוף ושירת הים המפורסמת.', img: 'https://images.unsplash.com/photo-1439405326854-01517487c73b?w=400' },
                { id: 'yitro', name: 'יתרו', desc: 'מעמד הר סיני ומתן עשרת הדיברות.', img: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400' },
                { id: 'mishpatim', name: 'משפטים', desc: 'מצוות חברתיות רבות ודיני משפט.', img: 'https://images.unsplash.com/photo-1450101499163-c8848c66ca85?w=400' },
                { id: 'terumah', name: 'תרומה', desc: 'הציווי על הקמת המשכן וכליו.', img: 'https://images.unsplash.com/photo-1519046904884-53103b34b206?w=400' },
                { id: 'tetzaveh', name: 'תצוה', desc: 'בגדי הכהונה המפוארים והמנורה.', img: 'https://images.unsplash.com/photo-1510002165351-784860178385?w=400' },
                { id: 'ki-tisa', name: 'כי תשא', desc: 'חטא העגל ומחצית השקל.', img: 'https://images.unsplash.com/photo-1534447677768-be436bb09401?w=400' },
                { id: 'vayakhel', name: 'ויקהל', desc: 'התכנסות העם לבניית המשכן בפועל.', img: 'https://images.unsplash.com/photo-1473448912268-2022ce9509d8?w=400' },
                { id: 'pekudei', name: 'פקודי', desc: 'סיכום המלאכה והשראת השכינה.', img: 'https://images.unsplash.com/photo-1445108849235-41a09707b931?w=400' }
            ]},
            'vaikra': { name: 'ספר ויקרא', desc: 'עבודת המקדש, הקדושה והחובות המוסריות.', color: '#a855f7', lightColor: '#6b21a8', icon: 'temple_hindu', hero: 'https://images.unsplash.com/photo-1519817650390-64a93db51149?q=80&w=1600', parashot: [
                { id: 'vaikra', name: 'ויקרא', desc: 'דיני הקרבנות השונים במשכן.', img: 'https://images.unsplash.com/photo-1519817650390-64a93db51149?w=400' },
                { id: 'tzav', name: 'צו', desc: 'הוראות לכהנים על עבודת המזבח.', img: 'https://images.unsplash.com/photo-1533713619779-3c7333550066?w=400' },
                { id: 'shemini', name: 'שמיני', desc: 'חנוכת המשכן ומאכלות אסורים.', img: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400' },
                { id: 'tazria', name: 'תזריע', desc: 'דיני טומאה וטהרה בבני אדם.', img: 'https://images.unsplash.com/photo-1473448912268-2022ce9509d8?w=400' },
                { id: 'metzora', name: 'מצורע', desc: 'תהליך הטהרה והחיבור לקהילה.', img: 'https://images.unsplash.com/photo-1445108849235-41a09707b931?w=400' },
                { id: 'acharei-mot', name: 'אחרי מות', desc: 'עבודת יום הכיפורים הקדושה.', img: 'https://images.unsplash.com/photo-1502481851512-e9e2529bbbf9?w=400' },
                { id: 'kedoshim', name: 'קדושים', desc: 'ציווי הקדושה ומצוות ואהבת לרעך.', img: 'https://images.unsplash.com/photo-1470770841072-f978cf4d019e?w=400' },
                { id: 'emor', name: 'אמור', desc: 'מועדי ישראל ודיני הכהונה.', img: 'https://images.unsplash.com/photo-1426604966848-d7adac402bdb?w=400' },
                { id: 'behar', name: 'בהר', desc: 'שנת השמיטה ושנת היובל.', img: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400' },
                { id: 'bechukotai', name: 'בחקותי', desc: 'הבטחות לברכה ואזהרות הברית.', img: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=400' }
            ]},
            'bamidbar': { name: 'ספר במדבר', desc: 'מסע בני ישראל במדבר סיני אל הארץ המובטחת.', color: '#d97706', lightColor: '#92400e', icon: 'landscape', hero: 'https://images.unsplash.com/photo-1473580044384-7ba9967e16a0?q=80&w=1600', parashot: [
                { id: 'bamidbar', name: 'במדבר', desc: 'מפקד בני ישראל וסידור המחנות.', img: 'https://images.unsplash.com/photo-1473580044384-7ba9967e16a0?w=400' },
                { id: 'naso', name: 'נשא', desc: 'מצוות נזיר וברכת הכהנים.', img: 'https://images.unsplash.com/photo-1445108849235-41a09707b931?w=400' },
                { id: 'behaalotcha', name: 'בהעלותך', desc: 'העלאת המנורה והנהגת הענן.', img: 'https://images.unsplash.com/photo-1502481851512-e9e2529bbbf9?w=400' },
                { id: 'shelach', name: 'שלח לך', desc: 'חטא המרגלים ותוצאותיו.', img: 'https://images.unsplash.com/photo-1439853949127-fa647821eba0?w=400' },
                { id: 'korach', name: 'קורח', desc: 'מחלוקת קורח ועדתו נגד משה.', img: 'https://images.unsplash.com/photo-1534447677768-be436bb09401?w=400' },
                { id: 'chukat', name: 'חוקת', desc: 'פרה אדומה ופטירת מרים ואהרון.', img: 'https://images.unsplash.com/photo-1507039228107-160565866160?w=400' },
                { id: 'balak', name: 'בלק', desc: 'בלעם מנסה לקלל ונמצא מברך.', img: 'https://images.unsplash.com/photo-1470770841072-f978cf4d019e?w=400' },
                { id: 'pinchas', name: 'פנחס', desc: 'שכר פנחס ומפקד בני ישראל.', img: 'https://images.unsplash.com/photo-1518005020250-68a0508b2400?w=400' },
                { id: 'matot', name: 'מטות', desc: 'דיני נדרים והמלחמה במדין.', img: 'https://images.unsplash.com/photo-1426604966848-d7adac402bdb?w=400' },
                { id: 'masei', name: 'מסעי', desc: 'סיכום מסעות ישראל וגבולות הארץ.', img: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=400' }
            ]},
            'devarim': { name: 'ספר דברים', desc: 'נאום הפרידה של משה רבנו וסיכום המצוות.', color: '#0284c7', lightColor: '#075985', icon: 'record_voice_over', hero: 'https://images.unsplash.com/photo-1490682143124-b73ed7311835?q=80&w=1600', parashot: [
                { id: 'devarim', name: 'דברים', desc: 'משה מתחיל את נאומו בסיכום המסע.', img: 'https://images.unsplash.com/photo-1490682143124-b73ed7311835?w=400' },
                { id: 'vaetchanan', name: 'ואתחנן', desc: 'תפילת משה וקריאת שמע.', img: 'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400' },
                { id: 'eikev', name: 'עקב', desc: 'ברכת המזון והבטחת השפע.', img: 'https://images.unsplash.com/photo-1445108849235-41a09707b931?w=400' },
                { id: 'reeh', name: 'ראה', desc: 'הבחירה בין ברכה לקללה.', img: 'https://images.unsplash.com/photo-1502481851512-e9e2529bbbf9?w=400' },
                { id: 'shofetim', name: 'שופטים', desc: 'מינוי דיינים ומנהיגות בישראל.', img: 'https://images.unsplash.com/photo-1450101499163-c8848c66ca85?w=400' },
                { id: 'ki-tetze', name: 'כי תצא', desc: 'עשרות מצוות חברתיות ומוסריות.', img: 'https://images.unsplash.com/photo-1518005020250-68a0508b2400?w=400' },
                { id: 'ki-tavo', name: 'כי תבוא', desc: 'מצוות הביכורים והברית בארץ.', img: 'https://images.unsplash.com/photo-1470770841072-f978cf4d019e?w=400' },
                { id: 'nitzavim', name: 'ניצבים', desc: 'מעמד הברית והבחירה בחיים.', img: 'https://images.unsplash.com/photo-1426604966848-d7adac402bdb?w=400' },
                { id: 'vayelech', name: 'וילך', desc: 'העברת ההנהגה ליהושע.', img: 'https://images.unsplash.com/photo-1472396961693-142e6e269027?w=400' },
                { id: 'haazinu', name: 'האזינו', desc: 'שירת משה כעדות נצחית.', img: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?w=400' },
                { id: 'vezot-haberacha', name: 'וזאת הברכה', desc: 'ברכות משה האחרונות וסיכום התורה.', img: 'https://images.unsplash.com/photo-1519046904884-53103b34b206?w=400' }
            ]}
        };

        function handleImageError(imgElement, color) {
            const container = imgElement.parentElement;
            imgElement.style.display = 'none';
            container.classList.add('image-fallback');
            container.style.background = `linear-gradient(135deg, ${color}22, ${color}44)`;
            container.innerHTML = `<span class="material-symbols-outlined text-4xl" style="color: ${color}88">menu_book</span>`;
        }

        async function initPage() {
            const params = new URLSearchParams(window.location.search);
            const bookId = params.get('book') || 'bereshit';
            const data = booksData[bookId] || booksData['bereshit'];

            document.getElementById('page-title').textContent = data.name;
            document.getElementById('main-title').textContent = data.name;
            document.getElementById('main-description').textContent = data.desc;
            
            const heroBg = document.getElementById('hero-bg');
            const heroSection = document.getElementById('hero-section');
            
            if (data.hero) {
                heroBg.style.backgroundImage = `url('${data.hero}')`;
            } else {
                heroBg.style.opacity = '0';
                heroSection.style.setProperty('--book-color-dark', data.lightColor);
                heroSection.style.setProperty('--book-color-light', data.color);
                heroSection.classList.add('hero-gradient-fallback');
            }

            document.getElementById('icon-container').style.backgroundColor = data.color;
            document.getElementById('book-icon').textContent = data.icon;

            const grid = document.getElementById('parasha-grid');
            grid.innerHTML = ''; 

            data.parashot.forEach(p => {
                const card = document.createElement('div');
                const gradientFrame = `linear-gradient(135deg, ${data.color}, ${data.lightColor})`;

                card.innerHTML = `
                    <a href="article.html?parasha=${p.id}&book=${bookId}" 
                       class="group relative p-[1.5px] rounded-3xl no-underline floating-card overflow-hidden block">
                        <div class="card-inner-bg relative rounded-[calc(1.5rem-1.5px)] overflow-hidden flex h-32 md:h-44 items-stretch p-2">
                            <div class="w-28 md:w-60 h-full overflow-hidden flex-shrink-0 rounded-2xl shadow-inner border border-black/5 relative bg-slate-50">
                                <img src="${p.img}" id="img-${p.id}" 
                                     onerror="handleImageError(this, '${data.color}')"
                                     class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-1000">
                            </div>
                            <div class="p-4 md:p-8 flex flex-col justify-center flex-grow">
                                <h3 class="text-xl md:text-2xl font-bold mb-2" id="title-${p.id}" style="color: ${data.color}">
                                    ${p.name}
                                </h3>
                                <p class="text-slate-600 text-sm md:text-lg line-clamp-2 leading-relaxed font-normal" id="desc-${p.id}">
                                    ${p.desc}
                                </p>
                            </div>
                            <div class="flex items-center px-4 md:px-8">
                                <span class="material-symbols-outlined opacity-20 group-hover:opacity-100 group-hover:translate-x-[-5px] transition-all duration-500" style="color: ${data.color}">
                                    arrow_back_ios
                                </span>
                            </div>
                        </div>
                        <div class="absolute inset-0 rounded-3xl pointer-events-none" style="border: 1.5px solid transparent; background: ${gradientFrame} border-box; -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0); -webkit-mask-composite: destination-out; mask-composite: exclude;"></div>
                    </a>
                `;
                grid.appendChild(card);

                // החזרת פונקציית הקריאה מקובצי הטקסט (fetch)
                fetch(`parashot/${p.id}.txt`)
                    .then(response => response.ok ? response.text() : null)
                    .then(text => {
                        if (text) {
                            const lines = text.split('\n');
                            lines.forEach(line => {
                                if (line.startsWith('title:')) document.getElementById(`title-${p.id}`).textContent = line.replace('title:', '').trim();
                                if (line.startsWith('subtitle:')) document.getElementById(`desc-${p.id}`).textContent = line.replace('subtitle:', '').trim();
                                if (line.startsWith('image:')) {
                                    const imgUrl = line.replace('image:', '').trim();
                                    if(imgUrl) document.getElementById(`img-${p.id}`).src = imgUrl;
                                    else handleImageError(document.getElementById(`img-${p.id}`), data.color);
                                }
                            });
                        }
                    })
                    .catch(() => {});
            });
        }

        window.addEventListener('scroll', () => {
            const scroll = window.scrollY;
            const heroContent = document.getElementById('hero-content');
            const backBtn = document.getElementById('back-link');
            const heroBg = document.getElementById('hero-bg');
            const opacityValue = Math.max(0, 1 - scroll / 450);
            const blurValue = Math.min(20, scroll / 12);
            
            heroContent.style.opacity = opacityValue;
            heroContent.style.filter = `blur(${blurValue}px)`;
            if(backBtn) {
                backBtn.style.opacity = opacityValue;
            }
            if (heroBg) {
                heroBg.style.filter = `blur(${blurValue / 2}px)`;
                heroBg.style.transform = `scale(${1 + scroll / 1200})`;
            }
        });

        initPage();
    </script>
</body>
</html>
